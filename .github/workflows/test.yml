name: SSH into EC2 Instance

on:
  push:
    branches:
      - main

jobs:
  ssh-into-ec2:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v2

      - name: Install SSH Client
        run: sudo apt-get install -y openssh-client

      - name: Set up AWS .pem File
        run: echo "$AWS_PEM_FILE" | base64 --decode > mlops.pem && chmod 600 mlops.pem

      - name: SSH into EC2 Instance
        env:
          INSTANCE_IP: <YOUR_EC2_INSTANCE_IP>
          INSTANCE_USER: <YOUR_EC2_INSTANCE_USERNAME>
        run: |
          ssh -o StrictHostKeyChecking=no -i mlops.pem ${INSTANCE_USER}@${INSTANCE_IP} 'your_remote_command'
